<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Datos de Invitados</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .data-display { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0; }
        .guest-item { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .guest-name { font-weight: bold; color: #333; }
        .guest-data { font-family: monospace; font-size: 0.9em; color: #666; }
        .event-list { margin: 5px 0; padding: 5px; background: #e9ecef; border-radius: 3px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>üß™ Test Estructura de Datos de Invitados</h1>
    
    <div class="test-section">
        <h3>Obtener Datos de Invitados</h3>
        <button onclick="fetchGuestData()">üìä Cargar Datos de Invitados</button>
        <button onclick="clearData()">üóëÔ∏è Limpiar</button>
    </div>
    
    <div class="test-section">
        <h3>Resultados</h3>
        <div id="results"></div>
    </div>
    
    <script>
        async function fetchGuestData() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Cargando datos...</p>';
            
            try {
                // Obtener token de admin
                const adminToken = localStorage.getItem('adminToken') || 'test-token';
                
                const response = await fetch('/api/admin/invitados', {
                    method: 'GET',
                    headers: {
                        'Authorization': adminToken,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                console.log('Datos completos recibidos:', data);
                
                // Mostrar estructura de datos
                let html = '<h4>üìã Estructura de Datos de Invitados</h4>';
                
                if (Array.isArray(data) && data.length > 0) {
                    data.forEach((invitado, index) => {
                        html += `
                            <div class="guest-item">
                                <div class="guest-name">üë§ ${invitado.nombre} (${invitado.email})</div>
                                <div class="guest-data">
                                    <strong>Propiedades disponibles:</strong><br>
                                    ${Object.keys(invitado).map(key => `‚Ä¢ ${key}: ${JSON.stringify(invitado[key])}`).join('<br>')}
                                </div>
                                
                                <div class="event-list">
                                    <strong>üîç An√°lisis de eventos:</strong><br>
                                    ‚Ä¢ eventosAsistencia: ${invitado.eventosAsistencia ? '‚úÖ Existe' : '‚ùå No existe'}<br>
                                    ‚Ä¢ eventos: ${invitado.eventos ? '‚úÖ Existe' : '‚ùå No existe'}<br>
                                    ‚Ä¢ asistenciaEventos: ${invitado.asistenciaEventos ? '‚úÖ Existe' : '‚ùå No existe'}<br>
                                    ‚Ä¢ eventosConfirmados: ${invitado.eventosConfirmados ? '‚úÖ Existe' : '‚ùå No existe'}<br>
                                    ‚Ä¢ asistencia: ${invitado.asistencia ? `‚úÖ "${invitado.asistencia}"` : '‚ùå No existe'}
                                </div>
                            </div>
                        `;
                    });
                } else {
                    html += '<p>‚ùå No se recibieron datos de invitados o la estructura no es un array.</p>';
                }
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('Error al obtener datos:', error);
                resultsDiv.innerHTML = `
                    <p>‚ùå Error al obtener datos:</p>
                    <div class="data-display">${error.message}</div>
                `;
            }
        }
        
        function clearData() {
            document.getElementById('results').innerHTML = '';
        }
        
        // Cargar datos autom√°ticamente al abrir la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Test de datos de invitados cargado');
        });
    </script>
</body>
</html>


